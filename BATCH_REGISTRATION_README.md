# 批量用户注册程序使用说明

## 概述

本程序为智慧实验室电子班牌系统提供批量用户注册功能，支持从CSV文件导入或交互式输入的方式批量创建用户账户。

## 功能特性

- ✅ **CSV文件批量导入**: 支持从Excel或CSV文件批量导入用户数据
- ✅ **交互式注册**: 通过命令行交互式输入用户信息
- ✅ **数据验证**: 自动验证用户数据的完整性和格式
- ✅ **重复检查**: 自动检查用户名是否已存在
- ✅ **密码加密**: 自动对用户密码进行安全加密存储
- ✅ **错误处理**: 详细的错误信息和处理结果统计
- ✅ **示例生成**: 自动生成CSV模板文件

## 安装依赖

在运行程序前，请确保安装了必要的Python包：

```bash
pip install pandas flask flask-sqlalchemy pymysql cryptography
```

## 使用方法

### 1. 启动程序

```bash
python batch_user_registration.py
```

### 2. 选择注册方式

程序提供4种操作选项：

#### 选项1: 从CSV文件批量注册

1. 准备CSV文件，包含以下列（必填字段用*标记）：
   - `username*`: 用户名（最大50字符）
   - `password*`: 密码
   - `full_name*`: 真实姓名（最大100字符）
   - `email`: 邮箱地址（可选，最大100字符）
   - `phone_number`: 手机号码（可选，最大20字符）

2. 选择选项1，输入CSV文件路径
3. 程序将自动读取并批量注册用户

#### 选项2: 交互式批量注册

1. 选择选项2
2. 按提示逐个输入用户信息
3. 输入 `quit` 结束注册

#### 选项3: 生成示例CSV文件

1. 选择选项3
2. 输入文件名（默认：sample_users.csv）
3. 程序将生成包含示例数据的CSV模板

#### 选项4: 退出程序

## CSV文件格式示例

```csv
username,password,full_name,email,phone_number
student001,password123,张三,zhangsan@example.com,13800138001
student002,password123,李四,lisi@example.com,13800138002
teacher001,teacher123,王老师,wangteacher@example.com,13800138003
```

## 数据验证规则

### 必填字段
- `username`: 用户名
- `password`: 密码
- `full_name`: 真实姓名

### 字段限制
- 用户名：最大50个字符，不能重复
- 真实姓名：最大100个字符
- 邮箱：最大100个字符，必须包含@符号
- 手机号：最大20个字符

### 自动处理
- 密码自动加密存储
- 空白字符自动去除
- 重复用户名自动跳过

## 运行结果

程序运行完成后会显示详细的统计信息：

```
批量注册结果摘要
===========================================
成功注册: 15 个用户
注册失败: 2 个用户
总计处理: 17 个用户

失败详情:
1. 第3行: 用户名 'admin' 已存在
2. 第8行: 数据验证失败: 邮箱格式不正确

注册完成!
```

## 常见问题

### Q: 程序提示数据库连接失败
A: 请检查以下配置：
- MySQL服务是否启动
- 数据库连接信息是否正确（用户名、密码、数据库名）
- 网络连接是否正常

### Q: CSV文件读取失败
A: 请确保：
- 文件路径正确
- 文件格式为UTF-8编码
- CSV文件包含必要的列标题

### Q: 用户注册失败
A: 常见原因：
- 用户名已存在
- 必填字段为空
- 字段长度超出限制
- 邮箱格式不正确

### Q: 如何修改数据库连接配置
A: 编辑 `batch_user_registration.py` 文件中的数据库连接字符串：
```python
app.config['SQLALCHEMY_DATABASE_URI'] = 'mysql+pymysql://用户名:密码@主机:端口/数据库名'
```

## 安全注意事项

1. **密码安全**: 程序会自动对密码进行加密，但建议：
   - 使用强密码策略
   - 定期提醒用户更改密码
   - 避免在CSV文件中使用相同密码

2. **文件安全**: 
   - CSV文件包含敏感信息，使用后应及时删除
   - 不要将包含密码的CSV文件存储在公共位置

3. **权限控制**:
   - 仅授权管理员使用此程序
   - 定期审查注册的用户账户

## 技术支持

如遇到问题，请检查：
1. Python环境和依赖包是否正确安装
2. 数据库服务是否正常运行
3. 网络连接是否稳定
4. 文件权限是否足够

---

**注意**: 本程序直接操作数据库，建议在使用前先在测试环境中验证功能。